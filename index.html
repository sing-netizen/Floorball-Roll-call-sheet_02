<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è»Ÿå¼æ›²æ£çƒæŠ€è¡“æ”¹è‰¯è¨“ç·´ç­é»åç³»çµ±</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: "Microsoft JhengHei", Arial, sans-serif;
        }
        body {
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        select, input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .buttons {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        button {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            flex: 1;
            min-width: 150px;
        }
        button:hover {
            background-color: #45a049;
        }
        #whatsappOutput {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 4px;
            white-space: pre-line;
            font-family: Arial, sans-serif;
            line-height: 1.5;
        }
        .copy-btn {
            background-color: #25D366;
        }
        .copy-btn:hover {
            background-color: #128C7E;
        }
        .status-Yes {
            color: #2ecc71;
        }
        .status-Abs {
            color: #f39c12;
        }
        .status-O {
            color: #e74c3c;
        }
        .status-L {
            color: #3498db;
        }
        .status-S {
            color: #9b59b6;
        }
        .status-C {
            color: #1abc9c;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>è»Ÿå¼æ›²æ£çƒæŠ€è¡“æ”¹è‰¯è¨“ç·´ç­é»åç³»çµ±</h1>
        
        <div class="form-group">
            <label for="trainingDate">è¨“ç·´æ—¥æœŸ</label>
            <input type="date" id="trainingDate">
        </div>
        
        <div class="form-group">
            <label for="trainingTime">è¨“ç·´æ™‚é–“</label>
            <select id="trainingTime">
                <option value="æ˜ŸæœŸä¸€ã€å…­ (18:00-20:00)">æ˜ŸæœŸä¸€ã€å…­ (18:00-20:00)</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="trainingLocation">è¨“ç·´åœ°é»</label>
            <select id="trainingLocation">
                <option value="ä¹é¾ç£é«”è‚²é¤¨">ä¹é¾ç£é«”è‚²é¤¨</option>
                <option value="ç´…ç£¡å¸‚æ”¿å¤§å»ˆé«”è‚²é¤¨">ç´…ç£¡å¸‚æ”¿å¤§å»ˆé«”è‚²é¤¨</option>
                <option value="ä¹é¾ç£é‹å‹•å ´">ä¹é¾ç£é‹å‹•å ´</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="coachGroup">æ•™ç·´çµ„åˆ</label>
            <select id="coachGroup">
                <option value="å½­å®¶å¨ã€ä½•å®¶ç‘©">å½­å®¶å¨ã€ä½•å®¶ç‘©</option>
                <option value="ä½•æ˜Œæ†ã€ä½•å®¶ç‘©">ä½•æ˜Œæ†ã€ä½•å®¶ç‘©</option>
                <option value="å½­å®¶å¨">å½­å®¶å¨</option>
                <option value="ä½•æ˜Œæ†">ä½•æ˜Œæ†</option>
                <option value="ä½•å®¶ç‘©">ä½•å®¶ç‘©</option>
            </select>
        </div>
        
        <div class="table-container">
            <table id="attendanceTable">
                <thead>
                    <tr>
                        <th>ç·¨è™Ÿ</th>
                        <th>å§“å</th>
                        <th>é¡åˆ¥</th>
                        <th>å‡ºå¸­ç‹€æ…‹</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- é‹å‹•å“¡åå–® -->
                    <tr>
                        <td>1</td>
                        <td>ç¾…ç¿¹é‹’</td>
                        <td>é‹å‹•å“¡</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>é™³å“è¬™</td>
                        <td>é‹å‹•å“¡</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>æ—æ—¥æœ—</td>
                        <td>é‹å‹•å“¡</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>ææµ©ç”Ÿ</td>
                        <td>é‹å‹•å“¡</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>é™³æ–‡è¼</td>
                        <td>é‹å‹•å“¡</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>é™³æ–‡å‚‘</td>
                        <td>é‹å‹•å“¡</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>7</td>
                        <td>æç©é§¿</td>
                        <td>é‹å‹•å“¡</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>8</td>
                        <td>å‘‚å®¶è¯</td>
                        <td>é‹å‹•å“¡</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>9</td>
                        <td>æ—å¿—å¿ </td>
                        <td>é‹å‹•å“¡</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td>æ›¹ä¿Šæ¥­</td>
                        <td>é‹å‹•å“¡</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>11</td>
                        <td>ä½•å­éµ¬</td>
                        <td>é‹å‹•å“¡</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>12</td>
                        <td>å³åœ‹æµ©</td>
                        <td>é‹å‹•å“¡</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>13</td>
                        <td>çŸ³æŒ¯æ˜Ÿ</td>
                        <td>é‹å‹•å“¡</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    
                    <!-- èåˆä¼™ä¼´åå–® -->
                    <tr>
                        <td>14</td>
                        <td>é™³è€ƒç†’</td>
                        <td>èåˆä¼™ä¼´</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>15</td>
                        <td>éº¥å‰ä¿Š</td>
                        <td>èåˆä¼™ä¼´</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>16</td>
                        <td>é™³èŠ¯å„€</td>
                        <td>èåˆä¼™ä¼´</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>17</td>
                        <td>æ±ŸéŸ»è</td>
                        <td>èåˆä¼™ä¼´</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>18</td>
                        <td>å¤ä»²æ–‡</td>
                        <td>èåˆä¼™ä¼´</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>19</td>
                        <td>é»ƒå±•æ‚…</td>
                        <td>èåˆä¼™ä¼´</td>
                        <td>
                            <select class="status-select">
                                <option value="Yes">âœ… å‡ºå¸­</option>
                                <option value="Abs">ğŸ“ è«‹å‡</option>
                                <option value="O">âŒ ç„¡æ•…ç¼ºå¸­</option>
                                <option value="L">â° é²åˆ°</option>
                                <option value="S">ğŸ¤’ ç—…å‡</option>
                                <option value="C">ğŸ† å‡ºå¤–æ¯”è³½</option>
                            </select>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="buttons">
            <button id="generateWhatsApp">ç”ŸæˆWhatsAppé»åè¨˜éŒ„</button>
            <button id="copyToClipboard" class="copy-btn">è¤‡è£½åˆ°å‰ªè²¼ç°¿</button>
            <button id="resetAll">é‡ç½®æ‰€æœ‰ç‹€æ…‹</button>
        </div>
        
        <div class="form-group">
            <label for="whatsappOutput">WhatsAppé»åè¨˜éŒ„</label>
            <div id="whatsappOutput"></div>
        </div>
    </div>

    <script>
        // è¨­ç½®é»˜èªæ—¥æœŸç‚ºä»Šå¤©
        document.getElementById('trainingDate').valueAsDate = new Date();
        
        // ç”ŸæˆWhatsAppé»åè¨˜éŒ„
        document.getElementById('generateWhatsApp').addEventListener('click', function() {
            const date = document.getElementById('trainingDate').value;
            const time = document.getElementById('trainingTime').value;
            const location = document.getElementById('trainingLocation').value;
            const coaches = document.getElementById('coachGroup').value;
            
            // æ ¼å¼åŒ–æ—¥æœŸ
            const formattedDate = formatDate(date);
            
            let output = `ğŸ’ è»Ÿå¼æ›²æ£çƒæŠ€è¡“æ”¹è‰¯è¨“ç·´ç­é»åè¨˜éŒ„ ğŸ’\n\n`;
            output += `ğŸ“… è¨“ç·´æ—¥æœŸï¼š${formattedDate}\n`;
            output += `â° è¨“ç·´æ™‚é–“ï¼š${time}\n`;
            output += `ğŸ“ è¨“ç·´åœ°é»ï¼š${location}\n`;
            output += `ğŸ‘¨â€ğŸ« è² è²¬æ•™ç·´ï¼š${coaches}\n\n`;
            
            // é‹å‹•å“¡å‡ºå¸­æƒ…æ³
            output += `ğŸ‘¥ é‹å‹•å“¡å‡ºå¸­æƒ…æ³ï¼š\n`;
            let athleteCount = 0;
            for (let i = 1; i <= 13; i++) {
                const row = document.querySelector(`#attendanceTable tbody tr:nth-child(${i})`);
                const name = row.cells[1].textContent;
                const status = row.cells[3].querySelector('select').value;
                const statusText = getStatusText(status);
                
                output += `${i}. ${name} - ${statusText}\n`;
                if (status === 'Yes') athleteCount++;
            }
            output += `é‹å‹•å“¡å‡ºå¸­äººæ•¸ï¼š${athleteCount}/13\n\n`;
            
            // èåˆä¼™ä¼´å‡ºå¸­æƒ…æ³
            output += `ğŸ¤ èåˆä¼™ä¼´å‡ºå¸­æƒ…æ³ï¼š\n`;
            let partnerCount = 0;
            for (let i = 14; i <= 19; i++) {
                const row = document.querySelector(`#attendanceTable tbody tr:nth-child(${i})`);
                const name = row.cells[1].textContent;
                const status = row.cells[3].querySelector('select').value;
                const statusText = getStatusText(status);
                
                output += `${i}. ${name} - ${statusText}\n`;
                if (status === 'Yes') partnerCount++;
            }
            output += `èåˆä¼™ä¼´å‡ºå¸­äººæ•¸ï¼š${partnerCount}/6\n\n`;
            
            // ç¸½å‡ºå¸­æƒ…æ³
            output += `ğŸ“Š ç¸½å‡ºå¸­æƒ…æ³ï¼š\n`;
            output += `âœ… å‡ºå¸­ï¼š${athleteCount + partnerCount}/19\n`;
            
            // æ·»åŠ ç”Ÿæˆæ™‚é–“
            const now = new Date();
            const generatedTime = formatDateTime(now);
            output += `\næ­¤è¨˜éŒ„ç”±é»åç³»çµ±è‡ªå‹•ç”Ÿæˆ\nç”Ÿæˆæ™‚é–“ï¼š${generatedTime}`;
            
            document.getElementById('whatsappOutput').textContent = output;
        });
        
        // è¤‡è£½åˆ°å‰ªè²¼ç°¿
        document.getElementById('copyToClipboard').addEventListener('click', function() {
            const outputText = document.getElementById('whatsappOutput').textContent;
            if (outputText) {
                navigator.clipboard.writeText(outputText).then(function() {
                    alert('å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼');
                }, function(err) {
                    console.error('è¤‡è£½å¤±æ•—: ', err);
                });
            } else {
                alert('è«‹å…ˆç”ŸæˆWhatsAppé»åè¨˜éŒ„ï¼');
            }
        });
        
        // é‡ç½®æ‰€æœ‰ç‹€æ…‹
        document.getElementById('resetAll').addEventListener('click', function() {
            const selects = document.querySelectorAll('.status-select');
            selects.forEach(select => {
                select.value = 'Yes';
            });
            document.getElementById('whatsappOutput').textContent = '';
        });
        
        // è¼”åŠ©å‡½æ•¸ï¼šæ ¼å¼åŒ–æ—¥æœŸ
        function formatDate(dateString) {
            const date = new Date(dateString);
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}å¹´${month}æœˆ${day}æ—¥`;
        }
        
        // è¼”åŠ©å‡½æ•¸ï¼šæ ¼å¼åŒ–æ—¥æœŸæ™‚é–“
        function formatDateTime(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            const seconds = String(date.getSeconds()).padStart(2, '0');
            return `${year}å¹´${month}æœˆ${day}æ—¥ ${hours}:${minutes}:${seconds}`;
        }
        
        // è¼”åŠ©å‡½æ•¸ï¼šç²å–ç‹€æ…‹æ–‡å­—
        function getStatusText(status) {
            switch(status) {
                case 'Yes': return 'âœ… å‡ºå¸­';
                case 'Abs': return 'ğŸ“ è«‹å‡';
                case 'O': return 'âŒ ç„¡æ•…ç¼ºå¸­';
                case 'L': return 'â° é²åˆ°';
                case 'S': return 'ğŸ¤’ ç—…å‡';
                case 'C': return 'ğŸ† å‡ºå¤–æ¯”è³½';
                default: return 'æœªçŸ¥ç‹€æ…‹';
            }
        }
    </script>
</body>
</html>
