<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è»Ÿå¼æ›²æ£çƒæŠ€è¡“æ”¹è‰¯è¨“ç·´ç­é»åç³»çµ±</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background-color: #1a5f7a;
            color: white;
            padding: 25px 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 5px solid #ffcc00;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .logo {
            width: 80px;
            height: 80px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1a5f7a;
            font-size: 36px;
            font-weight: bold;
        }
        
        .header-text h1 {
            font-size: 28px;
            margin-bottom: 8px;
        }
        
        .header-text p {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            padding: 0;
        }
        
        .control-panel {
            flex: 0 0 300px;
            background-color: #f8f9fa;
            padding: 25px;
            border-right: 1px solid #e0e0e0;
        }
        
        .attendance-section {
            flex: 1;
            padding: 25px;
            min-width: 300px;
        }
        
        .section-title {
            font-size: 22px;
            color: #1a5f7a;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ffcc00;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: #1a5f7a;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
        }
        
        select, input[type="date"] {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
            background-color: white;
        }
        
        .coach-combination {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin-top: 10px;
        }
        
        .coach-combination p {
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .status-legend {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
            background-color: white;
            border-radius: 5px;
            padding: 15px;
            border: 1px solid #ddd;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .status-emoji {
            font-size: 18px;
        }
        
        .attendance-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .attendance-table th {
            background-color: #1a5f7a;
            color: white;
            text-align: left;
            padding: 15px;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        .attendance-table td {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .attendance-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .attendance-table tr:hover {
            background-color: #f0f7ff;
        }
        
        .status-dropdown {
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 14px;
            width: 100%;
            cursor: pointer;
        }
        
        .status-yes { background-color: #e7f7e7; }
        .status-abs { background-color: #fff8e1; }
        .status-o { background-color: #ffeaea; }
        .status-l { background-color: #e3f2fd; }
        .status-s { background-color: #f3e5f5; }
        .status-c { background-color: #e0f2f1; }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 14px 25px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 200px;
        }
        
        .btn-primary {
            background-color: #1a5f7a;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #0d4c63;
        }
        
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #218838;
        }
        
        .btn-whatsapp {
            background-color: #25D366;
            color: white;
        }
        
        .btn-whatsapp:hover {
            background-color: #1da851;
        }
        
        .output-section {
            margin-top: 40px;
            border-top: 2px solid #eee;
            padding-top: 30px;
        }
        
        .output-container {
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 20px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
            font-size: 15px;
            line-height: 1.5;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            color: #666;
            font-size: 14px;
            border-top: 1px solid #eee;
        }
        
        @media (max-width: 900px) {
            .main-content {
                flex-direction: column;
            }
            
            .control-panel {
                border-right: none;
                border-bottom: 1px solid #e0e0e0;
            }
            
            .btn {
                min-width: 100%;
            }
        }
        
        .category-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .athlete-badge {
            background-color: #e3f2fd;
            color: #1565c0;
        }
        
        .partner-badge {
            background-color: #f3e5f5;
            color: #7b1fa2;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-section">
                <div class="logo">HK</div>
                <div class="header-text">
                    <h1>è»Ÿå¼æ›²æ£çƒæŠ€è¡“æ”¹è‰¯è¨“ç·´ç­é»åç³»çµ±</h1>
                    <p>ä¸­åœ‹é¦™æ¸¯æ™ºéšœäººå£«é«”è‚²å”æœƒ</p>
                </div>
            </div>
            <div class="date-display">
                <div id="current-date"></div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="control-panel">
                <div class="section-title">
                    <i class="fas fa-cog"></i> ç³»çµ±è¨­å®š
                </div>
                
                <div class="form-group">
                    <label for="training-date"><i class="far fa-calendar-alt"></i> è¨“ç·´æ—¥æœŸ</label>
                    <input type="date" id="training-date">
                </div>
                
                <div class="form-group">
                    <label for="training-time"><i class="far fa-clock"></i> è¨“ç·´æ™‚é–“</label>
                    <select id="training-time">
                        <option value="æ˜ŸæœŸä¸€ (18:00-20:00)">æ˜ŸæœŸä¸€ (18:00-20:00)</option>
                        <option value="æ˜ŸæœŸå…­ (18:00-20:00)">æ˜ŸæœŸå…­ (18:00-20:00)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="training-location"><i class="fas fa-map-marker-alt"></i> è¨“ç·´åœ°é»</label>
                    <select id="training-location">
                        <option value="ä¹é¾ç£é«”è‚²é¤¨">ä¹é¾ç£é«”è‚²é¤¨</option>
                        <option value="ä¹é¾ç£é‹å‹•å ´">ä¹é¾ç£é‹å‹•å ´</option>
                        <option value="ç´…ç£¡å¸‚æ”¿å¤§å»ˆé«”è‚²é¤¨">ç´…ç£¡å¸‚æ”¿å¤§å»ˆé«”è‚²é¤¨</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="coach-combination"><i class="fas fa-users"></i> æ•™ç·´çµ„åˆ</label>
                    <select id="coach-combination">
                        <option value="å½­å®¶å¨ã€ä½•å®¶ç‘©">å½­å®¶å¨ã€ä½•å®¶ç‘©</option>
                        <option value="ä½•æ˜Œæ†ã€ä½•å®¶ç‘©">ä½•æ˜Œæ†ã€ä½•å®¶ç‘©</option>
                        <option value="å½­å®¶å¨ã€æ—å»ºç¼">å½­å®¶å¨ã€æ—å»ºç¼</option>
                        <option value="å½­å®¶å¨">å½­å®¶å¨</option>
                        <option value="ä½•æ˜Œæ†">ä½•æ˜Œæ†</option>
                        <option value="ä½•å®¶ç‘©">ä½•å®¶ç‘©</option>
                    </select>
                </div>
                
                <div class="status-legend">
                    <div class="status-item">
                        <span class="status-emoji">âœ…</span> Yes: å‡ºå¸­
                    </div>
                    <div class="status-item">
                        <span class="status-emoji">ğŸ“</span> Abs: è«‹å‡
                    </div>
                    <div class="status-item">
                        <span class="status-emoji">âŒ</span> O: ç„¡æ•…ç¼ºå¸­
                    </div>
                    <div class="status-item">
                        <span class="status-emoji">â°</span> L: é²åˆ°
                    </div>
                    <div class="status-item">
                        <span class="status-emoji">ğŸ¤’</span> S: ç—…å‡
                    </div>
                    <div class="status-item">
                        <span class="status-emoji">ğŸ†</span> C: å‡ºå¤–æ¯”è³½
                    </div>
                </div>
            </div>
            
            <div class="attendance-section">
                <div class="section-title">
                    <i class="fas fa-clipboard-list"></i> é»åè¨˜éŒ„
                </div>
                
                <table class="attendance-table">
                    <thead>
                        <tr>
                            <th>ç·¨è™Ÿ</th>
                            <th>é¡åˆ¥</th>
                            <th>æ©Ÿæ§‹åç¨±</th>
                            <th>å§“å</th>
                            <th>æ€§åˆ¥</th>
                            <th>å‡ºå¸­ç‹€æ…‹</th>
                        </tr>
                    </thead>
                    <tbody id="attendance-body">
                        <!-- é‹å‹•å“¡å’Œèåˆå¤¥ä¼´æ•¸æ“šå°‡åœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
                    </tbody>
                </table>
                
                <div class="buttons">
                    <button class="btn btn-primary" id="update-btn">
                        <i class="fas fa-sync-alt"></i> æ›´æ–°é»åè¨˜éŒ„
                    </button>
                    <button class="btn btn-success" id="generate-btn">
                        <i class="fas fa-file-alt"></i> ç”ŸæˆWhatsAppæ–‡æ¡ˆ
                    </button>
                    <button class="btn btn-whatsapp" id="whatsapp-btn">
                        <i class="fab fa-whatsapp"></i> å‚³é€è‡³WhatsApp
                    </button>
                </div>
                
                <div class="output-section">
                    <div class="section-title">
                        <i class="fas fa-comment-alt"></i> WhatsAppæ¨é€æ–‡æ¡ˆ
                    </div>
                    <div class="output-container" id="output-text"></div>
                    <div class="buttons">
                        <button class="btn btn-primary" id="copy-btn">
                            <i class="far fa-copy"></i> è¤‡è£½æ–‡æ¡ˆ
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Â© 2023 ä¸­åœ‹é¦™æ¸¯æ™ºéšœäººå£«é«”è‚²å”æœƒ - è»Ÿå¼æ›²æ£çƒæŠ€è¡“æ”¹è‰¯è¨“ç·´ç­é»åç³»çµ±</p>
            <p>æ­¤ç³»çµ±åƒ…ä¾›å…§éƒ¨ä½¿ç”¨</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // è¨­ç½®ç•¶å‰æ—¥æœŸ
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];
            document.getElementById('training-date').value = formattedDate;
            
            // æ›´æ–°æ—¥æœŸé¡¯ç¤º
            const dateOptions = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
            document.getElementById('current-date').textContent = today.toLocaleDateString('zh-HK', dateOptions);
            
            // é‹å‹•å“¡å’Œèåˆå¤¥ä¼´æ•¸æ“š
            const participants = [
                // é‹å‹•å“¡ (1-13)
                { id: 1, category: 'athlete', org: 'ç‰¹å¥§ä¹‹å‹', name: 'ç¾…ç¿¹é‹’', gender: 'M' },
                { id: 2, category: 'athlete', org: 'æ¾å¶ºè·è¨“', name: 'é™³å“è¬™', gender: 'M' },
                { id: 3, category: 'athlete', org: 'è§€å¡˜å±•äº®', name: 'æ—æ—¥æœ—', gender: 'M' },
                { id: 4, category: 'athlete', org: 'å¾ªé“è¡›ç†', name: 'ææµ©ç”Ÿ', gender: 'M' },
                { id: 5, category: 'athlete', org: 'ç‰¹å¥§ä¹‹å‹', name: 'é™³æ–‡è¼', gender: 'M' },
                { id: 6, category: 'athlete', org: 'ç‰¹å¥§ä¹‹å‹', name: 'é™³æ–‡å‚‘', gender: 'M' },
                { id: 7, category: 'athlete', org: 'ç‰¹å¥§ä¹‹å‹', name: 'æç©é§¿', gender: 'M' },
                { id: 8, category: 'athlete', org: 'ç‰¹å¥§ä¹‹å‹', name: 'å‘‚å®¶è¯', gender: 'M' },
                { id: 9, category: 'athlete', org: 'ç‰¹å¥§ä¹‹å‹', name: 'æ—å¿—å¿ ', gender: 'M' },
                { id: 10, category: 'athlete', org: 'ç‰¹å¥§ä¹‹å‹', name: 'æ›¹ä¿Šæ¥­', gender: 'M' },
                { id: 11, category: 'athlete', org: 'ç‰¹å¥§ä¹‹å‹', name: 'ä½•å­éµ¬', gender: 'M' },
                { id: 12, category: 'athlete', org: 'æ²™ç”°å…¬ç«‹', name: 'å³åœ‹æµ©', gender: 'M' },
                { id: 13, category: 'athlete', org: 'è¥¿å€æ™¨è¼', name: 'çŸ³æŒ¯æ˜Ÿ', gender: 'M' },
                
                // èåˆå¤¥ä¼´ (14-19)
                { id: 14, category: 'partner', org: 'èåˆä¼™ä¼´', name: 'é™³è€ƒç†’', gender: 'F' },
                { id: 15, category: 'partner', org: 'èåˆä¼™ä¼´', name: 'éº¥å‰ä¿Š', gender: 'M' },
                { id: 16, category: 'partner', org: 'èåˆä¼™ä¼´', name: 'é™³èŠ¯å„€', gender: 'F' },
                { id: 17, category: 'partner', org: 'èåˆä¼™ä¼´', name: 'æ±ŸéŸ»è', gender: 'F' },
                { id: 18, category: 'partner', org: 'èåˆä¼™ä¼´', name: 'å¤ä»²æ–‡', gender: 'F' },
                { id: 19, category: 'partner', org: 'èåˆä¼™ä¼´', name: 'é»ƒå±•æ‚…', gender: 'F' }
            ];
            
            // ç‹€æ…‹é¸é …èˆ‡å°æ‡‰çš„emoji
            const statusOptions = [
                { value: 'Yes', text: 'âœ… Yes: å‡ºå¸­', class: 'status-yes' },
                { value: 'Abs', text: 'ğŸ“ Abs: è«‹å‡', class: 'status-abs' },
                { value: 'O', text: 'âŒ O: ç„¡æ•…ç¼ºå¸­', class: 'status-o' },
                { value: 'L', text: 'â° L: é²åˆ°', class: 'status-l' },
                { value: 'S', text: 'ğŸ¤’ S: ç—…å‡', class: 'status-s' },
                { value: 'C', text: 'ğŸ† C: å‡ºå¤–æ¯”è³½', class: 'status-c' }
            ];
            
            // åˆå§‹åŒ–é»åè¡¨æ ¼
            function initAttendanceTable() {
                const tbody = document.getElementById('attendance-body');
                tbody.innerHTML = '';
                
                participants.forEach(participant => {
                    const row = document.createElement('tr');
                    
                    // ç·¨è™Ÿ
                    const idCell = document.createElement('td');
                    idCell.textContent = participant.id;
                    
                    // é¡åˆ¥
                    const categoryCell = document.createElement('td');
                    const categoryBadge = document.createElement('span');
                    if (participant.category === 'athlete') {
                        categoryBadge.textContent = 'é‹å‹•å“¡';
                        categoryBadge.className = 'category-badge athlete-badge';
                    } else {
                        categoryBadge.textContent = 'èåˆå¤¥ä¼´';
                        categoryBadge.className = 'category-badge partner-badge';
                    }
                    categoryCell.appendChild(categoryBadge);
                    
                    // æ©Ÿæ§‹åç¨±
                    const orgCell = document.createElement('td');
                    orgCell.textContent = participant.org;
                    
                    // å§“å
                    const nameCell = document.createElement('td');
                    nameCell.textContent = participant.name;
                    
                    // æ€§åˆ¥
                    const genderCell = document.createElement('td');
                    genderCell.textContent = participant.gender === 'M' ? 'ç”·' : 'å¥³';
                    
                    // å‡ºå¸­ç‹€æ…‹ (ä¸‹æ‹‰å¼é¸å–®)
                    const statusCell = document.createElement('td');
                    const select = document.createElement('select');
                    select.className = 'status-dropdown';
                    select.id = `status-${participant.id}`;
                    
                    // è¨­ç½®é»˜èªå€¼
                    let defaultValue = 'Yes';
                    if (participant.id === 2 || participant.id === 7) defaultValue = 'Abs';
                    if (participant.id === 15) defaultValue = 'L';
                    
                    statusOptions.forEach(option => {
                        const optElement = document.createElement('option');
                        optElement.value = option.value;
                        optElement.textContent = option.text;
                        if (option.value === defaultValue) {
                            optElement.selected = true;
                            select.className = `status-dropdown ${option.class}`;
                        }
                        select.appendChild(optElement);
                    });
                    
                    // ç•¶ç‹€æ…‹æ”¹è®Šæ™‚æ›´æ–°èƒŒæ™¯é¡è‰²
                    select.addEventListener('change', function() {
                        const selectedOption = statusOptions.find(opt => opt.value === this.value);
                        this.className = `status-dropdown ${selectedOption.class}`;
                    });
                    
                    statusCell.appendChild(select);
                    
                    // å°‡æ‰€æœ‰å–®å…ƒæ ¼æ·»åŠ åˆ°è¡Œä¸­
                    row.appendChild(idCell);
                    row.appendChild(categoryCell);
                    row.appendChild(orgCell);
                    row.appendChild(nameCell);
                    row.appendChild(genderCell);
                    row.appendChild(statusCell);
                    
                    tbody.appendChild(row);
                });
            }
            
            // ç”ŸæˆWhatsAppæ¨é€æ–‡æ¡ˆ
            function generateWhatsAppText() {
                const date = document.getElementById('training-date').value;
                const time = document.getElementById('training-time').value;
                const location = document.getElementById('training-location').value;
                const coaches = document.getElementById('coach-combination').value;
                
                // æ ¼å¼åŒ–æ—¥æœŸ
                const dateObj = new Date(date);
                const formattedDate = dateObj.toLocaleDateString('zh-HK', { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' });
                
                // ç²å–ç•¶å‰æ™‚é–“
                const now = new Date();
                const generatedTime = now.toLocaleString('zh-HK');
                
                let output = `ğŸ’ è»Ÿå¼æ›²æ£çƒæŠ€è¡“æ”¹è‰¯è¨“ç·´ç­é»åè¨˜éŒ„ ğŸ’\n\n`;
                output += `ğŸ“… æ—¥æœŸï¼š${formattedDate}\n`;
                output += `â° æ™‚é–“ï¼š${time}\n`;
                output += `ğŸ“ åœ°é»ï¼š${location}\n`;
                output += `ğŸ‘¨â€ğŸ« è² è²¬æ•™ç·´ï¼š${coaches}\n\n`;
                output += `=====================\n`;
                output += `ğŸƒâ€â™‚ï¸ é‹å‹•å“¡å‡ºå¸­è¨˜éŒ„ï¼š\n`;
                output += `=====================\n`;
                
                // é‹å‹•å“¡åå–®
                participants.filter(p => p.category === 'athlete').forEach(participant => {
                    const statusSelect = document.getElementById(`status-${participant.id}`);
                    const statusValue = statusSelect.value;
                    const statusText = statusOptions.find(opt => opt.value === statusValue).text;
                    
                    output += `${participant.id}. ${participant.org} ${participant.name} (${participant.gender === 'M' ? 'ç”·' : 'å¥³'}) - ${statusText}\n`;
                });
                
                output += `\n=====================\n`;
                output += `ğŸ¤ èåˆä¼™ä¼´å‡ºå¸­è¨˜éŒ„ï¼š\n`;
                output += `=====================\n`;
                
                // èåˆå¤¥ä¼´åå–®
                participants.filter(p => p.category === 'partner').forEach(participant => {
                    const statusSelect = document.getElementById(`status-${participant.id}`);
                    const statusValue = statusSelect.value;
                    const statusText = statusOptions.find(opt => opt.value === statusValue).text;
                    
                    output += `${participant.id}. ${participant.org} ${participant.name} (${participant.gender === 'M' ? 'ç”·' : 'å¥³'}) - ${statusText}\n`;
                });
                
                output += `\nğŸ“Š å‡ºå¸­çµ±è¨ˆï¼š\n`;
                
                // è¨ˆç®—çµ±è¨ˆ
                const athleteCount = participants.filter(p => p.category === 'athlete').length;
                const partnerCount = participants.filter(p => p.category === 'partner').length;
                const totalCount = athleteCount + partnerCount;
                
                let athleteYes = 0, partnerYes = 0;
                
                participants.forEach(participant => {
                    const statusSelect = document.getElementById(`status-${participant.id}`);
                    const statusValue = statusSelect.value;
                    
                    if (statusValue === 'Yes') {
                        if (participant.category === 'athlete') athleteYes++;
                        else partnerYes++;
                    }
                });
                
                output += `é‹å‹•å“¡ï¼š${athleteYes}/${athleteCount} å‡ºå¸­\n`;
                output += `èåˆä¼™ä¼´ï¼š${partnerYes}/${partnerCount} å‡ºå¸­\n`;
                output += `ç¸½å‡ºå¸­ç‡ï¼š${athleteYes + partnerYes}/${totalCount}\n\n`;
                output += `ğŸ“ æ­¤è¨˜éŒ„ç”±é»åç³»çµ±è‡ªå‹•ç”Ÿæˆ\n`;
                output += `ğŸ•’ ç”Ÿæˆæ™‚é–“ï¼š${generatedTime}\n`;
                output += `\nå‚³é€è‡³ WhatsApp`;
                
                document.getElementById('output-text').textContent = output;
                
                return output;
            }
            
            // è¤‡è£½æ–‡æ¡ˆåˆ°å‰ªè²¼æ¿
            function copyToClipboard() {
                const outputText = document.getElementById('output-text').textContent;
                navigator.clipboard.writeText(outputText).then(() => {
                    alert('æ–‡æ¡ˆå·²è¤‡è£½åˆ°å‰ªè²¼æ¿ï¼');
                }).catch(err => {
                    console.error('è¤‡è£½å¤±æ•—: ', err);
                });
            }
            
            // æ‰“é–‹WhatsAppåˆ†äº«
            function shareToWhatsApp() {
                const whatsappText = generateWhatsAppText();
                const encodedText = encodeURIComponent(whatsappText);
                const whatsappUrl = `https://api.whatsapp.com/send?text=${encodedText}`;
                window.open(whatsappUrl, '_blank');
            }
            
            // æ›´æ–°é»åè¨˜éŒ„
            function updateAttendance() {
                // é€™è£¡å¯ä»¥æ·»åŠ ä¿å­˜åˆ°æœ¬åœ°å­˜å„²æˆ–æœå‹™å™¨çš„åŠŸèƒ½
                alert('é»åè¨˜éŒ„å·²æ›´æ–°ï¼');
            }
            
            // äº‹ä»¶ç›£è½å™¨
            document.getElementById('generate-btn').addEventListener('click', generateWhatsAppText);
            document.getElementById('copy-btn').addEventListener('click', copyToClipboard);
            document.getElementById('whatsapp-btn').addEventListener('click', shareToWhatsApp);
            document.getElementById('update-btn').addEventListener('click', updateAttendance);
            
            // åˆå§‹åŒ–è¡¨æ ¼
            initAttendanceTable();
            
            // åˆå§‹åŒ–æ™‚ç”Ÿæˆä¸€æ¬¡æ–‡æ¡ˆ
            generateWhatsAppText();
        });
    </script>
</body>
</html>
